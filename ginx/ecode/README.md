### 1. `ginx/ecode` æ–‡æ¡£ä¸æµ‹è¯•

# ginx/ecode

`ecode` æ˜¯ä¸€ä¸ªé€šç”¨é”™è¯¯ç å®šä¹‰ä¸çŠ¶æ€ç æ˜ å°„åº“ã€‚å®ƒå®ç°äº† **"æœºåˆ¶ä¸ç­–ç•¥åˆ†ç¦»"** çš„è®¾è®¡æ€æƒ³ï¼Œå¹¶é‡‡ç”¨ **"çº¦å®šä¼˜äºé…ç½®"** çš„ç­–ç•¥æ¥ç®€åŒ–å¼€å‘ã€‚

## âœ¨ ç‰¹æ€§

- **æ ‡å‡†ç»“æ„**ï¼šå®šä¹‰äº†ç»Ÿä¸€çš„ `Error` ç»“æ„ä½“ (Code, Msg, Details)ã€‚
- **é“¾å¼è°ƒç”¨**ï¼šæ”¯æŒ `WithDetails`ã€`WithCause` ç­‰é“¾å¼æ–¹æ³•ï¼Œä¸”ä¿è¯ä¸å¯å˜æ€§ã€‚
- **æ™ºèƒ½çŠ¶æ€ç æ˜ å°„**ï¼š
    - **Level 1 (æ³¨å†Œ)**ï¼šæ‰‹åŠ¨æ³¨å†Œçš„ HTTP çŠ¶æ€ç ä¼˜å…ˆçº§æœ€é«˜ (å¦‚ 404, 403)ã€‚
    - **Level 2 (çº¦å®š)**ï¼š
        - `2xxxxxx` (ä¸šåŠ¡é”™è¯¯) -> è‡ªåŠ¨æ˜ å°„ä¸º **HTTP 200**ã€‚
        - `1xxxxxx` (ç³»ç»Ÿé”™è¯¯) -> è‡ªåŠ¨æ˜ å°„ä¸º **HTTP 500**ã€‚
    - **Level 3 (å…œåº•)**ï¼šå…¶ä»–æƒ…å†µé»˜è®¤ä¸º **HTTP 500**ã€‚

## ğŸ“¦ å®‰è£…

```bash
go get -u github.com/einscat/ab-go
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. å®šä¹‰é”™è¯¯

```go
package ecode

var (
    // è‡ªåŠ¨æ˜ å°„ä¸º HTTP 200 (å› ä¸ºæ˜¯ 2 å¼€å¤´)
    UserDuplicate = New(2001001, "ç”¨æˆ·å·²å­˜åœ¨")
    
    // è‡ªåŠ¨æ˜ å°„ä¸º HTTP 500 (å› ä¸ºæ˜¯ 1 å¼€å¤´)
    DbError       = New(1001001, "æ•°æ®åº“è¿æ¥å¤±è´¥")

    // ç‰¹æ®Šé”™è¯¯ï¼Œç¨åéœ€è¦æ³¨å†Œ
    AuthFailed    = New(2001004, "è®¤è¯å¤±è´¥")
)
```

### 2. æ³¨å†Œç‰¹æ®ŠçŠ¶æ€ç  (å¯é€‰)

åœ¨ä¸šåŠ¡æ¨¡å—çš„ `init()` ä¸­æ³¨å†Œé‚£äº›**ä¸å¸Œæœ›éµå¾ªé»˜è®¤è§„åˆ™**çš„é”™è¯¯ã€‚

```go
import "net/http"

func init() {
    // å¼ºåˆ¶æŒ‡å®š AuthFailed è¿”å› 401ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„ 200
    RegisterStatus(AuthFailed.Code, http.StatusUnauthorized)
}
```

### 3. æºå¸¦è¯¦æƒ…

```go
// è¿”å›ä¸€ä¸ªæ–°çš„ error å®ä¾‹ï¼ŒåŒ…å«å…·ä½“çš„è¡¨å•é”™è¯¯ä¿¡æ¯
err := InvalidParams.WithDetails(map[string]string{
    "email": "æ ¼å¼é”™è¯¯",
})
```